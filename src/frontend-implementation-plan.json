{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "IC mainnet (dfx) deployment readiness for React frontend",
  "requirements": [
    {
      "id": "REQ-10",
      "summary": "Ensure the frontend build output and asset settings are compatible with an IC assets canister deployment via dfx.",
      "acceptanceCriteria": [
        "A `dfx deploy --network ic` from the repository root completes successfully and deploys all required canisters.",
        "The deployment configuration includes both the backend canister (Motoko) and a frontend assets canister that serves the built React app."
      ],
      "file_operations": [
        {
          "path": "frontend/.ic-assets.json5",
          "operation": "create",
          "description": "Add IC assets canister settings for the built frontend (e.g., caching rules for hashed assets and no-cache for HTML entry) so the React build can be safely served on mainnet. Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/index.html",
          "operation": "modify",
          "description": "Validate the HTML entry is compatible with being served from an IC assets canister (no localhost-only assumptions; relative asset references as needed for canister hosting). Verify the component's usage instructions before implementing."
        }
      ]
    },
    {
      "id": "REQ-11",
      "summary": "Add developer-facing production deployment runbook for mainnet IC that includes prerequisites, build/deploy commands, and how to retrieve the live URL/canister IDs and sign in with Internet Identity.",
      "acceptanceCriteria": [
        "Documentation includes exact commands to: build the frontend, deploy to `--network ic`, and locate the deployed canister IDs.",
        "Documentation explains how to open the deployed frontend in a browser (the live assets canister URL) and sign in with Internet Identity on mainnet."
      ],
      "file_operations": [
        {
          "path": "frontend/DEPLOYMENT_RUNBOOK.md",
          "operation": "create",
          "description": "Create README-style runbook focused on mainnet IC deployment for the app: required tooling (dfx), required environment values for mainnet builds, build steps for the React app, `dfx deploy --network ic`, how to locate canister IDs, and how to open the live assets canister URL and sign in with Internet Identity on mainnet. Verify the component's usage instructions before implementing."
        }
      ]
    },
    {
      "id": "REQ-13",
      "summary": "Make the deployed frontend use correct mainnet (`ic`) backend canister IDs and host configuration at runtime/build time (no local-only IDs in production).",
      "acceptanceCriteria": [
        "After `dfx deploy --network ic`, the hosted frontend can call the backend canister successfully on mainnet (e.g., load authenticated pages after signing in).",
        "No frontend code relies on local-only canister IDs when built/deployed for the `ic` network."
      ],
      "file_operations": [
        {
          "path": "frontend/src/config.ts",
          "operation": "create",
          "description": "Implement `createActorWithConfig` used by `frontend/src/hooks/useActor.ts` so it selects the correct backend canister ID and network host for `ic` builds (and does not default to local canister IDs in production). Keep compatibility with existing `useActor` behavior and options passing. Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/.env.ic",
          "operation": "create",
          "description": "Add mainnet build environment values (e.g., backend canister ID for `ic`, and any host/network selectors) consumed by `frontend/src/config.ts` during production builds. Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/hooks/useActor.ts",
          "operation": "modify",
          "description": "Update imports/typing expectations only if needed to align with the new `frontend/src/config.ts` implementation without changing the hook's overall behavior or authentication flow; do not introduce local-only canister ID fallbacks for production builds. Verify the component's usage instructions before implementing."
        }
      ]
    }
  ]
}